function doGet() {
  return HtmlService.createHtmlOutputFromFile('Index')
      .setTitle('ตารางเรียนของฉัน')
      .addMetaTag('viewport', 'width=device-width, initial-scale=1');
}

// ดึงข้อมูลตารางเรียนทั้งหมด
function getSchedule() {
  var props = PropertiesService.getUserProperties();
  var data = props.getProperty('mySchedule');
  return data ? JSON.parse(data) : [];
}

// บันทึกวิชาเรียนใหม่
function saveCourse(course) {
  var props = PropertiesService.getUserProperties();
  var data = props.getProperty('mySchedule');
  var schedule = data ? JSON.parse(data) : [];
  
  course.id = new Date().getTime().toString(); // สร้าง ID แบบสุ่มจากเวลา
  schedule.push(course);
  
  props.setProperty('mySchedule', JSON.stringify(schedule));
  return schedule;
}

// ลบวิชาเรียน
function deleteCourse(id) {
  var props = PropertiesService.getUserProperties();
  var data = props.getProperty('mySchedule');
  var schedule = data ? JSON.parse(data) : [];
  
  schedule = schedule.filter(function(c) { return c.id !== id; });
  props.setProperty('mySchedule', JSON.stringify(schedule));
  return schedule;
}
